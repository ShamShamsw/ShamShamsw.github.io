<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The best wait for it ... singing game made by the coolest person ever - Play Now</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-bg: #1a1a2e;
      --secondary-surface: #16213e;
      --text-color: #eaf0fb;
      --primary-action: #e94560;
      --secondary-action: #7b2cbf;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Nunito', sans-serif;
      background: var(--primary-bg);
      color: var(--text-color);
    }
    
    .title-font {
      font-family: 'Righteous', cursive;
    }
    
    .app-wrapper {
      width: 100%;
      min-height: 100%;
      background: linear-gradient(135deg, var(--primary-bg) 0%, #0f0f23 50%, var(--secondary-surface) 100%);
    }
    
    .card-container {
      background: linear-gradient(145deg, var(--secondary-surface), #1a1a3e);
      border: 3px solid var(--primary-action);
      box-shadow: 0 0 40px rgba(233, 69, 96, 0.3), inset 0 0 60px rgba(123, 44, 191, 0.1);
    }
    
    .mic-icon {
      filter: drop-shadow(0 0 10px var(--primary-action));
    }
    
    .player-btn {
      transition: all 0.2s ease;
      background: var(--secondary-surface);
      border: 2px solid var(--secondary-action);
    }
    
    .player-btn:hover {
      transform: scale(1.05);
      border-color: var(--primary-action);
      box-shadow: 0 0 20px rgba(233, 69, 96, 0.4);
    }
    
    .deck-option {
      transition: all 0.3s ease;
    }
    
    .deck-option:hover, .deck-option.selected {
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(233, 69, 96, 0.5);
    }
    
    .countdown-number {
      animation: pulse-grow 0.8s ease-in-out;
    }
    
    @keyframes pulse-grow {
      0% { transform: scale(0.5); opacity: 0; }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes confetti-fall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100%) rotate(720deg); opacity: 0; }
    }
    
    .confetti-piece {
      position: fixed;
      width: 10px;
      height: 10px;
      pointer-events: none;
      z-index: 1000;
    }
    
    .score-flash {
      animation: score-pulse 0.5s ease-out;
    }
    
    @keyframes score-pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); color: var(--primary-action); }
      100% { transform: scale(1); }
    }
    
    .slide-in {
      animation: slideIn 0.5s ease-out;
    }
    
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .winner-glow {
      animation: winner-pulse 1s ease-in-out infinite;
    }
    
    @keyframes winner-pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(233, 69, 96, 0.5); }
      50% { box-shadow: 0 0 40px rgba(233, 69, 96, 0.8), 0 0 60px rgba(123, 44, 191, 0.5); }
    }

    .musical-note {
      position: absolute;
      font-size: 24px;
      opacity: 0.1;
      pointer-events: none;
    }
    
    .back-home-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(123, 44, 191, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      text-decoration: none;
      font-weight: 600;
      z-index: 100;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .back-home-btn:hover {
      background: rgba(233, 69, 96, 0.9);
      transform: scale(1.05);
    }
  </style>
</head>
<body class="h-full">
  <a href="best-mic.html" class="back-home-btn">‚Üê Back to Project</a>
  
  <div class="app-wrapper overflow-auto" id="app">
    <!-- Setup Phase -->
    <div id="setup-phase" class="min-h-full p-4 md:p-8">
      <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-8 slide-in">
          <div class="flex justify-center items-center gap-3 mb-2">
            <svg class="w-12 h-12 mic-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" fill="var(--primary-action)"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2M12 19v4M8 23h8"/>
            </svg>
            <h1 id="main-title" class="title-font text-4xl md:text-6xl bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 bg-clip-text text-transparent">
              Sing It!
            </h1>
            <svg class="w-12 h-12 mic-icon transform scale-x-[-1]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" fill="var(--primary-action)"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2M12 19v4M8 23h8"/>
            </svg>
          </div>
          <p class="text-lg opacity-80">The Musical Lyric Party Game</p>
        </header>

        <!-- Instructions -->
        <div class="bg-gradient-to-r from-purple-900/50 to-pink-900/50 rounded-2xl p-6 mb-8 border border-purple-500/30 slide-in">
          <h2 class="title-font text-2xl mb-4 flex items-center gap-2">
            <span>üéµ</span> How to Play
          </h2>
          <div class="grid md:grid-cols-2 gap-4 text-sm md:text-base">
            <div class="flex items-start gap-3">
              <span class="text-2xl">1Ô∏è‚É£</span>
              <p>Draw a word card from your chosen musical deck</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">2Ô∏è‚É£</span>
              <p>Sing a lyric containing that word (any song!)</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">3Ô∏è‚É£</span>
              <p>Group decides if it counts - award points!</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">4Ô∏è‚É£</span>
              <p>First to <span id="winning-score-display" class="font-bold text-pink-400">10 points</span> wins! üèÜ</p>
            </div>
          </div>
          <div class="mt-4 pt-4 border-t border-purple-500/30 flex flex-wrap gap-4 text-sm">
            <div class="flex items-center gap-2">
              <span class="bg-green-500 px-3 py-1 rounded-full font-bold">1 PT</span>
              <span>Common words</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="bg-yellow-500 text-black px-3 py-1 rounded-full font-bold">2 PT</span>
              <span>Challenging words</span>
            </div>
          </div>
        </div>

        <!-- Player Setup -->
        <div class="bg-slate-800/50 rounded-2xl p-6 mb-6 border border-slate-600/30 slide-in">
          <h2 class="title-font text-2xl mb-4">üë• Players</h2>
          <div class="flex flex-wrap items-center gap-4 mb-6">
            <div class="flex items-center gap-3">
              <label for="player-count" class="font-semibold">Number of Players:</label>
              <select id="player-count" class="bg-slate-700 border border-slate-500 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
              </select>
            </div>
            <div class="flex items-center gap-3">
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="team-mode" class="sr-only peer">
                <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-pink-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-pink-600"></div>
                <span class="ml-3 font-semibold">Team Mode</span>
              </label>
            </div>
          </div>
          <div id="player-inputs" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
            <!-- Generated dynamically -->
          </div>
        </div>

        <!-- Deck Selection -->
        <div class="bg-slate-800/50 rounded-2xl p-6 mb-6 border border-slate-600/30 slide-in">
          <h2 class="title-font text-2xl mb-4">üé≠ Choose Your Deck</h2>
          <div id="deck-selection" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3">
            <!-- Generated dynamically -->
          </div>
        </div>

        <!-- Start Button -->
        <div class="text-center slide-in">
          <button id="start-game-btn" class="bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white font-bold py-4 px-12 rounded-full text-xl transition-all transform hover:scale-105 shadow-lg hover:shadow-pink-500/50">
            üé§ Start the Show!
          </button>
        </div>
      </div>
    </div>

    <!-- Game Phase -->
    <div id="game-phase" class="min-h-full p-4 md:p-6 hidden">
      <div class="max-w-6xl mx-auto">
        <!-- Game Header -->
        <header class="flex flex-wrap justify-between items-center mb-6 gap-4">
          <h1 id="game-title" class="title-font text-2xl md:text-3xl bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent">
            Sing It!
          </h1>
          <div class="flex gap-3">
            <button id="history-btn" class="bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg transition-colors flex items-center gap-2">
              üìú <span class="hidden md:inline">History</span>
            </button>
            <button id="back-to-setup" class="bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg transition-colors">
              ‚Üê Setup
            </button>
          </div>
        </header>

        <div class="grid lg:grid-cols-3 gap-6">
          <!-- Card Display Area -->
          <div class="lg:col-span-2">
            <div id="card-area" class="card-container rounded-3xl p-8 md:p-12 min-h-80 flex flex-col items-center justify-center relative overflow-hidden">
              <!-- Decorative notes -->
              <span class="musical-note top-4 left-4">‚ô™</span>
              <span class="musical-note top-8 right-8">‚ô´</span>
              <span class="musical-note bottom-4 left-8">‚ô¨</span>
              <span class="musical-note bottom-8 right-4">‚ô©</span>

              <div id="card-content" class="text-center z-10">
                <p class="text-xl opacity-70 mb-4">Ready to play?</p>
                <button id="draw-card-btn" class="bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white font-bold py-4 px-10 rounded-full text-xl transition-all transform hover:scale-105">
                  üé≤ Draw First Card
                </button>
              </div>
            </div>

            <!-- Award Points Section -->
            <div id="award-section" class="mt-6 hidden">
              <h3 class="text-center text-lg font-semibold mb-4 opacity-80">üèÜ Award Points To:</h3>
              <div id="player-buttons" class="flex flex-wrap justify-center gap-3">
                <!-- Generated dynamically -->
              </div>
              <div class="flex justify-center gap-4 mt-6">
                <button id="skip-card-btn" class="bg-slate-600 hover:bg-slate-500 px-6 py-3 rounded-xl transition-colors font-semibold">
                  ‚è≠Ô∏è Skip Card
                </button>
              </div>
            </div>
          </div>

          <!-- Scoreboard -->
          <div class="bg-slate-800/70 rounded-2xl p-4 md:p-6 border border-slate-600/30">
            <h2 class="title-font text-xl md:text-2xl mb-4 text-center">üèÜ Scoreboard</h2>
            <div id="scoreboard" class="space-y-2 max-h-96 overflow-y-auto">
              <!-- Generated dynamically -->
            </div>
            <div class="mt-4 pt-4 border-t border-slate-600/30 text-center">
              <p class="text-sm opacity-70">First to <span id="target-score" class="font-bold text-pink-400">10</span> wins!</p>
              <p class="text-xs opacity-60 mt-1">üëë Crown tracks the leader after 10 points</p>
              <p id="current-deck" class="text-sm opacity-70 mt-1">Deck: <span class="text-purple-400">All Decks</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Countdown Overlay -->
    <div id="countdown-overlay" class="fixed inset-0 bg-black/90 flex items-center justify-center z-50 hidden">
      <div id="countdown-display" class="title-font text-9xl md:text-[200px] text-pink-500 countdown-number"></div>
    </div>

    <!-- History Modal -->
    <div id="history-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-40 hidden p-4">
      <div class="bg-slate-800 rounded-2xl p-6 max-w-lg w-full max-h-[80%] overflow-hidden flex flex-col">
        <div class="flex justify-between items-center mb-4">
          <h2 class="title-font text-2xl">üìú Card History</h2>
          <button id="close-history" class="text-3xl hover:text-pink-400 transition-colors">&times;</button>
        </div>
        <div id="history-list" class="overflow-y-auto flex-1 space-y-2">
          <p class="text-center opacity-50">No cards drawn yet</p>
        </div>
      </div>
    </div>


  </div>

  <script>
    // Game State
    const gameState = {
      players: [],
      scores: {},
      currentDeck: 'all',
      teamMode: false,
      targetScore: 10,
      cardHistory: [],
      currentCard: null,
      gameStarted: false,
      cardAwarded: false,
      firstToTen: null
    };

    // Word Decks - themed word collections
    const decks = {
      hamilton: {
        name: 'Broadway',
        emoji: 'üé≠',
        color: 'from-amber-600 to-yellow-600',
        words: [
          { word: 'RISE', points: 1 },
          { word: 'FIGHT', points: 1 },
          { word: 'DREAM', points: 1 },
          { word: 'STAR', points: 1 },
          { word: 'HEART', points: 1 },
          { word: 'NIGHT', points: 1 },
          { word: 'WORLD', points: 1 },
          { word: 'TIME', points: 1 },
          { word: 'LIGHT', points: 1 },
          { word: 'HOME', points: 1 },
          { word: 'REVOLUTION', points: 2 },
          { word: 'LEGACY', points: 2 },
          { word: 'DESTINY', points: 2 },
          { word: 'TOMORROW', points: 1 },
          { word: 'FREEDOM', points: 2 },
          { word: 'HISTORY', points: 2 },
          { word: 'GLORY', points: 2 },
          { word: 'POWER', points: 1 },
          { word: 'STORY', points: 1 },
          { word: 'CHAMPION', points: 2 }
        ]
      },
      disney: {
        name: 'Disney',
        emoji: '‚ú®',
        color: 'from-blue-600 to-cyan-500',
        words: [
          { word: 'MAGIC', points: 1 },
          { word: 'WISH', points: 1 },
          { word: 'LOVE', points: 1 },
          { word: 'FLY', points: 1 },
          { word: 'DREAM', points: 1 },
          { word: 'HAPPY', points: 1 },
          { word: 'FRIEND', points: 1 },
          { word: 'FOREVER', points: 1 },
          { word: 'BELIEVE', points: 1 },
          { word: 'SHINE', points: 1 },
          { word: 'KINGDOM', points: 2 },
          { word: 'WONDER', points: 1 },
          { word: 'ADVENTURE', points: 2 },
          { word: 'COURAGE', points: 2 },
          { word: 'PRINCESS', points: 1 },
          { word: 'OCEAN', points: 1 },
          { word: 'RAINBOW', points: 1 },
          { word: 'ENCHANTED', points: 2 },
          { word: 'CASTLE', points: 1 },
          { word: 'FAIRY', points: 1 }
        ]
      },
      epic: {
        name: 'Epic/Rock',
        emoji: 'üé∏',
        color: 'from-red-600 to-orange-500',
        words: [
          { word: 'FIRE', points: 1 },
          { word: 'THUNDER', points: 1 },
          { word: 'ROCK', points: 1 },
          { word: 'WILD', points: 1 },
          { word: 'FREE', points: 1 },
          { word: 'NIGHT', points: 1 },
          { word: 'BURN', points: 1 },
          { word: 'CRAZY', points: 1 },
          { word: 'ELECTRIC', points: 2 },
          { word: 'MONSTER', points: 1 },
          { word: 'APOCALYPSE', points: 2 },
          { word: 'LEGENDARY', points: 2 },
          { word: 'IMMORTAL', points: 2 },
          { word: 'WARRIOR', points: 1 },
          { word: 'BATTLE', points: 1 },
          { word: 'STORM', points: 1 },
          { word: 'SCREAM', points: 1 },
          { word: 'HERO', points: 1 },
          { word: 'GLORY', points: 2 },
          { word: 'REBEL', points: 1 }
        ]
      },
      pop: {
        name: 'Pop Hits',
        emoji: 'üé§',
        color: 'from-pink-500 to-rose-500',
        words: [
          { word: 'BABY', points: 1 },
          { word: 'DANCE', points: 1 },
          { word: 'HEART', points: 1 },
          { word: 'LOVE', points: 1 },
          { word: 'TONIGHT', points: 1 },
          { word: 'PARTY', points: 1 },
          { word: 'CRAZY', points: 1 },
          { word: 'BEAUTIFUL', points: 1 },
          { word: 'SHAKE', points: 1 },
          { word: 'RADIO', points: 1 },
          { word: 'FIREWORK', points: 2 },
          { word: 'TELEPHONE', points: 2 },
          { word: 'UMBRELLA', points: 2 },
          { word: 'TITANIUM', points: 2 },
          { word: 'CHANDELIER', points: 2 },
          { word: 'DIAMONDS', points: 1 },
          { word: 'PERFECT', points: 1 },
          { word: 'STARBOY', points: 2 },
          { word: 'POISON', points: 1 },
          { word: 'ADDICTED', points: 2 }
        ]
      },
      hiphop: {
        name: 'Hip-Hop',
        emoji: 'üî•',
        color: 'from-purple-600 to-indigo-600',
        words: [
          { word: 'MONEY', points: 1 },
          { word: 'HUSTLE', points: 1 },
          { word: 'DREAMS', points: 1 },
          { word: 'REAL', points: 1 },
          { word: 'GAME', points: 1 },
          { word: 'STREETS', points: 1 },
          { word: 'KING', points: 1 },
          { word: 'QUEEN', points: 1 },
          { word: 'GRIND', points: 1 },
          { word: 'SHINE', points: 1 },
          { word: 'CONGRATULATIONS', points: 2 },
          { word: 'LIFESTYLE', points: 2 },
          { word: 'ROCKSTAR', points: 2 },
          { word: 'CHAMPION', points: 2 },
          { word: 'LEGENDARY', points: 2 },
          { word: 'EMPIRE', points: 2 },
          { word: 'HUMBLE', points: 1 },
          { word: 'LOYALTY', points: 2 },
          { word: 'VIBES', points: 1 },
          { word: 'BLESSED', points: 1 }
        ]
      },
      country: {
        name: 'Country',
        emoji: 'ü§†',
        color: 'from-yellow-600 to-amber-700',
        words: [
          { word: 'TRUCK', points: 1 },
          { word: 'ROAD', points: 1 },
          { word: 'BEER', points: 1 },
          { word: 'HOME', points: 1 },
          { word: 'HEART', points: 1 },
          { word: 'BOOTS', points: 1 },
          { word: 'DIRT', points: 1 },
          { word: 'SUMMER', points: 1 },
          { word: 'RIVER', points: 1 },
          { word: 'MAMA', points: 1 },
          { word: 'TENNESSEE', points: 2 },
          { word: 'WHISKEY', points: 1 },
          { word: 'SUNSHINE', points: 1 },
          { word: 'TAILGATE', points: 2 },
          { word: 'HONEYBEE', points: 2 },
          { word: 'WILDFLOWER', points: 2 },
          { word: 'COWBOYS', points: 1 },
          { word: 'FREEDOM', points: 2 },
          { word: 'BONFIRE', points: 2 },
          { word: 'DARLING', points: 1 }
        ]
      }
    };

    // DOM Elements
    const setupPhase = document.getElementById('setup-phase');
    const gamePhase = document.getElementById('game-phase');
    const playerCountSelect = document.getElementById('player-count');
    const teamModeToggle = document.getElementById('team-mode');
    const playerInputsContainer = document.getElementById('player-inputs');
    const deckSelection = document.getElementById('deck-selection');
    const startGameBtn = document.getElementById('start-game-btn');
    const cardArea = document.getElementById('card-area');
    const cardContent = document.getElementById('card-content');
    const drawCardBtn = document.getElementById('draw-card-btn');
    const awardSection = document.getElementById('award-section');
    const playerButtons = document.getElementById('player-buttons');
    const skipCardBtn = document.getElementById('skip-card-btn');
    const scoreboard = document.getElementById('scoreboard');
    const countdownOverlay = document.getElementById('countdown-overlay');
    const countdownDisplay = document.getElementById('countdown-display');
    const historyBtn = document.getElementById('history-btn');
    const historyModal = document.getElementById('history-modal');
    const historyList = document.getElementById('history-list');
    const closeHistoryBtn = document.getElementById('close-history');
    const backToSetupBtn = document.getElementById('back-to-setup');

    // Generate player input fields
    function generatePlayerInputs() {
      const count = parseInt(playerCountSelect.value);
      const isTeamMode = teamModeToggle.checked;
      const label = isTeamMode ? 'Team' : 'Player';
      
      playerInputsContainer.innerHTML = '';
      
      for (let i = 1; i <= count; i++) {
        const div = document.createElement('div');
        div.innerHTML = `
          <input type="text" 
            id="player-${i}" 
            placeholder="${label} ${i} name"
            class="w-full bg-slate-700 border border-slate-500 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"
          >
        `;
        playerInputsContainer.appendChild(div);
      }
    }

    // Generate deck selection buttons
    function generateDeckSelection() {
      deckSelection.innerHTML = '';
      
      // Add "All Decks" option
      const allDiv = document.createElement('button');
      allDiv.className = 'deck-option bg-gradient-to-br from-slate-600 to-slate-700 rounded-xl p-4 text-center cursor-pointer border-2 border-transparent selected';
      allDiv.dataset.deck = 'all';
      allDiv.innerHTML = `
        <div class="text-3xl mb-2">üéµ</div>
        <div class="font-bold text-sm">All Decks</div>
      `;
      deckSelection.appendChild(allDiv);
      
      // Add individual decks
      for (const [key, deck] of Object.entries(decks)) {
        const div = document.createElement('button');
        div.className = `deck-option bg-gradient-to-br ${deck.color} rounded-xl p-4 text-center cursor-pointer border-2 border-transparent`;
        div.dataset.deck = key;
        div.innerHTML = `
          <div class="text-3xl mb-2">${deck.emoji}</div>
          <div class="font-bold text-sm">${deck.name}</div>
        `;
        deckSelection.appendChild(div);
      }
      
      // Add click handlers
      deckSelection.querySelectorAll('.deck-option').forEach(btn => {
        btn.addEventListener('click', () => {
          deckSelection.querySelectorAll('.deck-option').forEach(b => b.classList.remove('selected', 'border-white'));
          btn.classList.add('selected', 'border-white');
          gameState.currentDeck = btn.dataset.deck;
        });
      });
    }

    // Start the game
    function startGame() {
      const count = parseInt(playerCountSelect.value);
      gameState.players = [];
      gameState.scores = {};
      gameState.teamMode = teamModeToggle.checked;
      gameState.cardHistory = [];
      gameState.firstToTen = null;
      gameState.cardAwarded = false;
      
      for (let i = 1; i <= count; i++) {
        const input = document.getElementById(`player-${i}`);
        const name = input.value.trim() || `${gameState.teamMode ? 'Team' : 'Player'} ${i}`;
        gameState.players.push(name);
        gameState.scores[name] = 0;
      }
      
      // Update deck display
      const deckName = gameState.currentDeck === 'all' ? 'All Decks' : decks[gameState.currentDeck].name;
      document.getElementById('current-deck').innerHTML = `Deck: <span class="text-purple-400">${deckName}</span>`;
      
      updateScoreboard();
      generatePlayerButtons();
      
      setupPhase.classList.add('hidden');
      gamePhase.classList.remove('hidden');
      
      // Reset card area
      cardContent.innerHTML = `
        <p class="text-xl opacity-70 mb-4">Ready to play?</p>
        <button id="draw-card-btn" class="bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white font-bold py-4 px-10 rounded-full text-xl transition-all transform hover:scale-105">
          üé≤ Draw First Card
        </button>
      `;
      document.getElementById('draw-card-btn').addEventListener('click', drawCard);
      awardSection.classList.add('hidden');
      
      gameState.gameStarted = true;
    }

    // Generate player award buttons
    function generatePlayerButtons() {
      playerButtons.innerHTML = '';
      
      gameState.players.forEach((player, index) => {
        const colors = ['from-pink-600 to-rose-600', 'from-blue-600 to-cyan-600', 'from-green-600 to-emerald-600', 'from-purple-600 to-indigo-600', 'from-yellow-600 to-amber-600', 'from-red-600 to-orange-600', 'from-teal-600 to-cyan-600', 'from-indigo-600 to-violet-600', 'from-fuchsia-600 to-pink-600', 'from-lime-600 to-green-600'];
        const color = colors[index % colors.length];
        
        const btn = document.createElement('button');
        btn.className = `player-btn bg-gradient-to-r ${color} px-6 py-3 rounded-xl font-bold transition-all`;
        btn.textContent = player;
        btn.addEventListener('click', () => awardPoints(player));
        playerButtons.appendChild(btn);
      });
    }

    // Update scoreboard
    function updateScoreboard() {
      const sortedPlayers = [...gameState.players].sort((a, b) => gameState.scores[b] - gameState.scores[a]);
      
      // If someone has reached 10 points, update crown holder to highest scorer
      if (gameState.firstToTen !== null) {
        const highestScore = Math.max(...Object.values(gameState.scores));
        const leadersWithHighScore = gameState.players.filter(p => gameState.scores[p] === highestScore);
        
        // If there's a tie and current crown holder is in the tie, they keep it
        if (leadersWithHighScore.length > 1 && leadersWithHighScore.includes(gameState.firstToTen)) {
          // Keep current crown holder
        } else {
          // Give crown to the highest scorer (first in sorted list)
          gameState.firstToTen = sortedPlayers[0];
        }
      }
      
      scoreboard.innerHTML = '';
      
      sortedPlayers.forEach((player, index) => {
        const score = gameState.scores[player];
        const isLeader = index === 0 && score > 0;
        const hasCrown = player === gameState.firstToTen;
        
        const div = document.createElement('div');
        div.id = `score-${player.replace(/\s+/g, '-')}`;
        div.className = `flex justify-between items-center p-3 rounded-xl transition-all ${hasCrown ? 'bg-gradient-to-r from-yellow-600/50 to-amber-600/50 border border-yellow-500' : isLeader ? 'bg-pink-600/30 border border-pink-500/50' : 'bg-slate-700/50'}`;
        div.innerHTML = `
          <div class="flex items-center gap-2">
            ${hasCrown ? '<span class="text-2xl">üëë</span>' : ''}
            <span class="font-semibold">${player}</span>
          </div>
          <span class="text-2xl font-bold ${hasCrown ? 'text-yellow-400' : ''}">${score}</span>
        `;
        scoreboard.appendChild(div);
      });
    }

    // Get random card
    function getRandomCard() {
      let availableWords = [];
      
      if (gameState.currentDeck === 'all') {
        for (const deck of Object.values(decks)) {
          availableWords = availableWords.concat(deck.words);
        }
      } else {
        availableWords = decks[gameState.currentDeck].words;
      }
      
      return availableWords[Math.floor(Math.random() * availableWords.length)];
    }

    // Show countdown then draw card
    async function drawCard() {
      countdownOverlay.classList.remove('hidden');
      
      for (let i = 3; i >= 1; i--) {
        countdownDisplay.textContent = i;
        countdownDisplay.className = 'title-font text-9xl md:text-[200px] text-pink-500 countdown-number';
        await new Promise(resolve => setTimeout(resolve, 800));
      }
      
      countdownDisplay.textContent = 'üé§';
      await new Promise(resolve => setTimeout(resolve, 500));
      
      countdownOverlay.classList.add('hidden');
      
      // Show card
      const card = getRandomCard();
      gameState.currentCard = card;
      gameState.cardHistory.push({ ...card, timestamp: Date.now() });
      
      const pointsBg = card.points === 2 ? 'bg-yellow-500 text-black' : 'bg-green-500';
      const difficulty = card.points === 2 ? 'Challenging' : 'Common';
      
      cardContent.innerHTML = `
        <div class="slide-in">
          <p class="text-sm uppercase tracking-widest opacity-60 mb-2">${difficulty} Word</p>
          <h2 class="title-font text-5xl md:text-7xl lg:text-8xl mb-6 float-animation bg-gradient-to-r from-pink-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent">
            ${card.word}
          </h2>
          <div class="flex justify-center gap-4 items-center">
            <span class="${pointsBg} px-4 py-2 rounded-full font-bold text-lg">
              ${card.points} ${card.points === 1 ? 'POINT' : 'POINTS'}
            </span>
          </div>
        </div>
      `;
      
      awardSection.classList.remove('hidden');
      gameState.cardAwarded = false;
    }

    // Award points to player
    function awardPoints(player) {
      if (!gameState.currentCard || gameState.cardAwarded) return;
      
      gameState.cardAwarded = true;
      
      const previousScore = gameState.scores[player];
      gameState.scores[player] += gameState.currentCard.points;
      const newScore = gameState.scores[player];
      
      // Check if this is the first player to reach 10 points
      if (newScore >= gameState.targetScore && !gameState.firstToTen) {
        gameState.firstToTen = player;
        triggerConfetti();
      }
      
      // Flash score animation
      updateScoreboard();
      const scoreEl = document.getElementById(`score-${player.replace(/\s+/g, '-')}`);
      if (scoreEl) {
        scoreEl.classList.add('score-flash');
        setTimeout(() => scoreEl.classList.remove('score-flash'), 500);
      }
      
      // Check for milestone (every 10 points)
      const previousMilestone = Math.floor(previousScore / 10);
      const newMilestone = Math.floor(newScore / 10);
      
      if (newMilestone > previousMilestone) {
        triggerConfetti();
      }
      
      // Automatically draw next card after a brief delay
      setTimeout(() => {
        drawCard();
      }, 1500);
    }

    // Trigger confetti celebration
    function triggerConfetti() {
      const colors = ['#e94560', '#7b2cbf', '#ffd700', '#00ff88', '#00bfff', '#ff6b6b'];
      const confettiCount = 50;
      
      for (let i = 0; i < confettiCount; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti-piece';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animation = `confetti-fall ${2 + Math.random() * 2}s linear forwards`;
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
        document.body.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 4000);
      }
    }

    // Update history modal
    function updateHistoryModal() {
      if (gameState.cardHistory.length === 0) {
        historyList.innerHTML = '<p class="text-center opacity-50">No cards drawn yet</p>';
        return;
      }
      
      historyList.innerHTML = gameState.cardHistory.slice().reverse().map((card, i) => `
        <div class="flex justify-between items-center p-3 bg-slate-700/50 rounded-lg">
          <span class="font-bold">${card.word}</span>
          <span class="${card.points === 2 ? 'bg-yellow-500 text-black' : 'bg-green-500'} px-2 py-1 rounded text-sm font-bold">
            ${card.points} PT
          </span>
        </div>
      `).join('');
    }

    // Event Listeners
    playerCountSelect.addEventListener('change', generatePlayerInputs);
    teamModeToggle.addEventListener('change', generatePlayerInputs);
    startGameBtn.addEventListener('click', startGame);
    skipCardBtn.addEventListener('click', () => {
      gameState.cardAwarded = false;
      drawCard();
    });
    
    historyBtn.addEventListener('click', () => {
      updateHistoryModal();
      historyModal.classList.remove('hidden');
    });
    
    closeHistoryBtn.addEventListener('click', () => {
      historyModal.classList.add('hidden');
    });
    
    historyModal.addEventListener('click', (e) => {
      if (e.target === historyModal) {
        historyModal.classList.add('hidden');
      }
    });
    
    backToSetupBtn.addEventListener('click', () => {
      gamePhase.classList.add('hidden');
      setupPhase.classList.remove('hidden');
      gameState.gameStarted = false;
      gameState.firstToTen = null;
      gameState.cardAwarded = false;
    });

    // Initialize
    generatePlayerInputs();
    generateDeckSelection();
  </script>
</body>
</html>
